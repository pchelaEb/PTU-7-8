1. АНАЛИЗ РЕЗУЛЬТАТОВ ИМИТАЦИННОГО МОДЕЛИРОВАНИЯ
      
      
      Для тестирования работы программы и анализа полученных результатов были специально придуманы несколько примеров, как простых, так и сложных цветных сетей Петри.
      При анализе результатов моделирования будем придерживаться следующего механизма. Выбираем какой-нибудь абстрактный объект, представляем его моделью с помощью цветной сетей Петри, строим графическое изображение сети, от графического изображения переходим к матричному представлению и с помощью разработанной программы анализируем свойства статической корректности. Графическое изображение будем использовать как раз для проверки корректности работы программы, т.к по этому изображению можно судить о достижимости позиций и живости переходов.
      
      
      5.1. Анализ результатов моделирования сети Петри с двумя цветами
      
      Пусть объект моделируется с помощью следующей цветной сети Петри изображенной на рисунке 5.1.

Представление объекта моделью на основе сети Петри с двумя цветами

Рис. 5.1

      Видим, что данный объект представлен моделью на основе цветной сети Петри с 2-мя цветами, с 3-мя позициями и 4-мя переходами. Начальная маркировка сети равна: в позиции Р1 находятся 3 метки черного цвета “a” и 2 метки серого “b”, в позиции Р2 – 2 метки черного цвета “a” и 3 метки серого “b” и в позиции Р3 – 2 метки черного цвета “a” и 4 метки серого “b”. Форма задания данной модели в программе представлена на рисунке 5.2.

Форма задания модели в программе

Рис.5.2
      
      Далее выполним моделирование и произведем анализ полученных результатов. Результаты моделирования можно посмотреть на рисунке 5.3. Из результатов моделирования видно, что данная модель работает великолепно, а именно все переходы живые, т.е. срабатывают, все позиции достижимы, метки каждого цвета движутся и, что в ней не существует тупиковых ситуаций. Также по каждой позиции сети можно посмотреть график ее загруженности за время моделирования. Для этого нужно выбрать любую из ячеек в столбце интересующей нас позиции, отметить галочками цвета меток, которые нас интересуют, в поле “Цвета модели”, нажать правую кнопку мыши и выбрать “График загруженности”. Именно так мы и поступим, посмотрим график загруженности для позиции Р2, по которому можно более детально проанализировать работу сети Петри с двумя цветами. График загруженности позиции Р2 представлен на рисунке 5.4.
Результаты моделирования

Рис.5.3

График загруженности позиции Р2

Рис. 5.4
      5.2. Анализ результатов моделирования сети Петри с тремя цветами

      Пусть объект моделируется с помощью следующей цветной сети Петри изображенной на рисунке 5.5.

Представление объекта моделью на основе сети Петри с тремя цветами

Рис. 5.5

      Видим, что данный объект представлен моделью на основе цветной сети Петри с 3-мя цветами, с 4-мя позициями и 5-ю переходами. Начальная маркировка сети равна: в позиции Р1 находятся 1 метка черного цвета “a” и 1 метка темно-серого “b”, в позиции Р2 – 1 метка темно-серого цвета “b” и 1 метка светло-серого “c”, в позиции Р3 – 1 метка темно-серого цвета “b” и 1 метка светло-серого “c” и в Р4 – 1 метка черного цвета “а”, 1 метка темно-серого “b” и 1 метка светло-серого “c”. Форма задания данной модели в программе представлена на рисунке 5.6. 
      Далее выполним моделирование и произведем анализ полученных результатов. Результаты моделирования можно посмотреть на рисунке 5.7. Из результатов моделирования видно, что данная модель тоже работает, т.е. все переходы живые (срабатывают), все позиции достижимы, метки каждого цвета движутся и, что в ней не существует тупиковых ситуаций.
      В целом программа дает предполагаемые результаты, следовательно, задачу, поставленную на дипломное проектирование, можно считать выполненной.
Форма задания модели в программе

Рис.5.6

Результаты моделирования

Рис.5.7
2. РАЗРАБОТКА ИНСТРУКЦИЙ ДЛЯ ПОЛЬЗОВАТЕЛЕЙ
      
      
      6.1. Инструкция для пользователя системы
      
      Разработанная система моделирования имеет простой графический интерфейс и удобна в работе. Внешний вид системы показан на рисунке 6.1. Сразу после открытия программы пользователь видит форму для заполнения данных. Остановимся подробно на каждом поле для ввода.
      В первую очередь пользователю следует задать количество позиций и переходов, из которых будет состоять моделируемая сеть. 
      Далее задается вектор максимальных емкостей позиций – максимальное количество меток, которое может одновременно находиться в данной позиции.
      Вектор временных задержек маркера в позициях содержит время, которое необходимо для активации метки в данной позиции. 
      Вектор начальной маркировки задает начальное распределение меток по позициям сети.
      Вектор временных задержек восстановления переходов показывает время, в течение которого после очередного срабатывания переход будет закрыт для перехода меток.
      Вектор приоритетов переходов позволяет задать очередность срабатывания переходов, если два и более перехода могут сработать одновременно и они имеют общие входные позиции. Приоритет перехода тем выше, чем больше введенное в соответствующую ячейку число.
      Матрица инцидентности нужна для того, чтобы задать структуру сети. Делается это следующим образом. Допустим, позиция Р1 соединена дугой веса “3а” (т.е. соединена тремя дугами цвета “а”) с переходом Т4. Если данная позиция является входящей для перехода Т4 (т.е. направление соединяющей их дуги от позиции к переходу) то в ячейке на пересечении позиции Р1 и перехода Т4 следует поставить “-3а”. Если же данная позиция является выходной для перехода Т4 (направление дуги от перехода к позиции), то в этой же ячейке следует поставить “+3а”. Так же следует показывать соединение других позиций и переходов – указывать вес дуги цифрой и буквой, где буква обозначает цвет дуги, а направление дуги – знаком “+” или “-”.
      Матрица ингибиторных дуг заполняется аналогично матрице инцидентности, ее отличие только в том, что она показывает не простые дуги, по которым движутся метки, а ингибиторные (по ним метки не движутся, они нужны только для управления состоянием сети в зависимости от маркировки позиций). Необходимо учесть тот момент, что данная позиция не может быть соединена с данным переходом простой дугой и ингибиторной, т.к. в этом случае возникает противоречие в условии срабатывания перехода. Поэтому необходимо следить за правильностью заполнения матриц, показывающих структуру сети.
      Для задания времен задержки маркера в позициях и времен восстановления переходов можно задать одно из двух распределений – нормальное или равномерное. Это можно сделать в пункте меню “Распределение”. При этом через знак # задается математическое ожидание и дисперсия, причем второе число должно быть строго меньше первого (например – 3.4#1.2). Целую и дробную часть следует задавать через точку. 
      
Внешний вид программы моделирования

Рис. 6.1
      
      При задании параметров системы предусмотрена проверка на правильность ввода данных. Например, в ячейки для ввода максимальных емкостей позиций нельзя ввести нецелое число. Также нельзя использовать другие символы кроме цифр и букв. Если же пользователь введет неправильные данные, то при запуске моделирования курсор окажется в первой ячейке с неправильными данными, после исправления этой ошибки при запуске моделирования он окажется в следующей ячейке с неверными параметрами и т.д., пока все параметры не будут заданы верно.
      Если в какой-либо ячейке данных ничего не будет введено, то по умолчанию будет считаться, что введен 0.
      Если пользователь будет не один раз моделировать какую-либо цветную сеть Петри, он может сохранить все введенные данные (структуру сети и ее параметры) в текстовый файл с расширением *.txt. Это можно сделать в пункте меню – “Файл” – “Сохранить”. Чтобы открыть файл с цветной сетью Петри, нужно воспользоваться пунктом меню – “Файл” – “Открыть” файл с расширение *.txt. Для того чтобы задать новую цветную сеть Петри, можно очистить все поля для ввода через пункт меню – “Файл” – “Создать”.
      После того, как заданы все необходимые данные, для моделирования цветной сети Петри следует выбрать пункт меню – “Моделирование”. При этом появится форма, внешний вид которой изображен на рисунке 6.2. На панели можно увидеть три кнопки с количеством шагов моделирования. Пользователь может проследить процесс моделирования за нужное ему число времени – нужно только определенное число раз нажать нужную кнопку. Также на панели есть кнопка “Протокол”, при нажатии на которую появится еще одна форма со всей статистикой моделирования; эту статистику можно сохранить в текстовый файл, нажав кнопку “Сохранить”. 
      В первой части статистики показывается распределение меток по позициям сети в течение времени моделирования. В ячейках активные и пассивные метки разделены двоеточием, например, 5а3b:2а1b означает, что в данный момент времени в данной позиции было активных – 5 меток цвета “a” и 3 метки цвета “b”, и пассивных – 2 метки цвета “a” и 1 метка цвета “b”. Так же можно проследить распределение меток по позициям сети как по каждому цвету отдельно, так и по нескольким цветам одновременно, например, для сравнения распределения меток по позициям сети цвета “а” и меток цвета “b”,  для этого нужно сделать следующее: поставить или убрать галочки соответствующих цветов меток в поле “Цвета модели”.
      Во второй части располагается статистика по позициям на последнем шаге моделирования, а именно, указывается число пассивных и активных меток каждого цвета в позиции; указывается максимальное число меток каждого цвета, которое одновременно оказывалось в позиции; указывается, сколько всего меток каждого цвета поступило за время моделирования в данную позицию; показывается загруженность позиции во времени (она определяется отношением двух времен – когда позиция была пуста и когда занята).
      В третьей части находится статистика по переходам: сколько раз сработал данный переход по каждому цвету меток; сколько раз данный переход не сработал по каждому цвету меток из-за того, что могла быть превышена максимальная емкость одной из выходных позиций для данного перехода; указывается время “сна” перехода по каждому цвету меток – общее время, в течение которого переход не мог сработать из-за его “восстановления”.
      
Процесс моделирования

Рис. 6.2

      Также по каждой позиции и каждому цвету метки сети можно посмотреть график ее загруженности за время моделирования. Для этого нужно выбрать любую из ячеек в столбце интересующей нас позиции, отметить галочкой цвет метки, который нас интересует, в поле “Цвета модели”, нажать правую кнопку мыши и выбрать “График загруженности”. Ещё имеется возможность построения графика загруженности в сравнении двух цветов меток. Например, нам необходимо сравнить графики загруженности меток цвета “а” и “с”. Для этого нужно выбрать любую из ячеек в столбце интересующей нас позиции, отметить галочками цвета меток “а” и “с” в поле “Цвета модели”, нажать правую кнопку мыши и выбрать “График загруженности”.
      Пример графика загруженности позиции приведен на рисунке 6.3. На графике синей линией показывается наличие пассивных меток цвета “a”, красной – активных меток цвета “a”, черной – всего меток цвета “a”, желтой – пассивных меток цвета “b”, бирюзовой – активных меток цвета “b”, зеленой – всего меток цвета “b”. Если в определенный момент времени в позиции находятся только активные или только пассивные метки определенного цвета, то на графике, на этом участке времени отображается соответственно красная или синяя линии для одного цвета меток или бирюзовая и желтая линии для другого цвета меток. Если в позиции присутствуют метки определенного цвета и активные и пассивные, то на графике, на этом промежутке времени будут отображаться красная и синяя линии для одного цвета меток и бирюзовая и желтая линии для другого цвета меток, а также их результирующие – линии черного цвета для одного и зеленого цвета для другого.
      
График загруженности

Рис. 6.3
      
      Инструкция для пользователя также имеется и в самой программе. 
      
      
      6.2. Внешние ограничения
      
      ПО реализовано на языке Delphi 6.0 на платформе  операционной системы Windows XP. Для модернизации программы необходим пакет Delphi 6.0. Для модификации программы необходимо наличие файлов с расширениями: *.pdf,  *.pas,  *.dcu,  *.dfm,  *.ddp.
      
      
      6.3. Перечень аппаратных и программных средств, необходимых для работы ПО
      
      Перечень аппаратных и программных средств, необходимых для работы ПО:
      При минимальной конфигурации:
      Процессор с тактовой частотой не меньше 133 MHz; ОЗУ – 16 МВ; Video – 4 МВ; ОС – Windows 95/98; ПО – Delphi 6.0, клавиатура, мышь.
      При оптимальной конфигурации:
      Процессор с тактовой частотой не меньше 333 MHz;  ОЗУ –  32 МB; Video – 8 МВ; ОС – Windows 95/98/2000; ПО – Delphi 6.0, клавиатура, мышь.
      При максимальной конфигурации:
      Процессор с тактовой частотой 750 MHz и более; ОЗУ – 64МВ и более; Video – 64МВ  более; ОС – Windows 98/2000/NT/XP; ПО – Delphi 6.0, клавиатура, мышь.

